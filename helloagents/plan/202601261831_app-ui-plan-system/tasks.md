# 任务清单: app-ui-plan-system

目录: `helloagents/plan/202601261831_app-ui-plan-system/`

---

## 任务状态符号说明

| 符号 | 状态 | 说明 |
|------|------|------|
| `[ ]` | pending | 待执行 |
| `[√]` | completed | 已完成 |
| `[X]` | failed | 执行失败 |
| `[-]` | skipped | 已跳过 |
| `[?]` | uncertain | 待确认 |

---

## 执行状态
```yaml
总任务: 31
已完成: 27
完成率: 87%
```

---

## 任务列表

### 1. 项目初始化与结构

- [√] 1.1 规划目录结构（建议 /web + /server）与端口/环境变量
  - 验证: 目录结构与配置文档可读

- [√] 1.2 初始化前端 Vite + React + Antd + TS
  - 验证: `pnpm dev` 或 `npm run dev` 可启动

- [√] 1.3 初始化后端 Go 模块与基础路由（建议 Gin）
  - 验证: `go test` 通过，健康检查接口可用

- [√] 1.4 基础工程规范（lint/format/commit 约定）
  - 验证: 基础检查命令可运行

- [√] 1.5 Docker Compose 编排（web/server/mysql/redis/tts）
  - 验证: `docker compose up` 可启动全部服务

### 2. 数据与临时表设计

- [√] 2.1 获取数据库连接信息并读取原表结构
  - 验证: 获取 app_ui_fields 等表的字段与约束

- [√] 2.2 设计临时表、历史表、媒体规则表与任务表
  - 验证: ERD 或表结构文档完整

- [√] 2.3 编写并执行迁移脚本（创建 draft_ 与 history_ 表）
  - 验证: 新表落库成功

- [√] 2.4 定义同步校验规则（线上表非空字段校验）
  - 验证: 校验规则可被 API 调用

- [√] 2.5 设计提交快照与差异对比的数据结构
  - 验证: 可生成字段级差异

### 3. 后端核心服务

- [√] 3.1 用户与角色（管理员/普通）认证与会话管理
  - 验证: 登录与权限控制可用

- [√] 3.2 任务分配/协作 API（创建/指派/协助/完成）
  - 验证: 任务状态与指派记录可查询

- [√] 3.3 版本基础信息模块（app_version_names + feishu 字段）
  - 验证: 版本名自动生成与可编辑

- [√] 3.4.1 草稿列表接口补全 OSS 签名 URL（轮播图/身份/场景/UI字段/配置项/服饰/拍摄偏好）
  - 验证: `/api/draft/*` 返回 `*_url` 字段

- [√] 3.4.2 轮播图/身份/场景/UI字段/配置项/视频等模块 CRUD
  - 验证: 全字段可保存与读取

- [√] 3.5 媒体上传校验与压缩流水线（图/视频/音频，含 OSS 预签名直传）
  - 验证: 超限文件被拒，合规文件自动处理

- [√] 3.6.1 提交/二次确认/差异对比/历史审计（基础接口）
  - 验证: 不同提交人触发 diff 视图与确认

- [√] 3.6.2 提交/二次确认/差异对比/历史审计（补全业务联动）
  - 验证: 草稿提交与审计记录完整

- [√] 3.7 同步到线上表（校验 + 写入 + 审计记录）
  - 验证: 同步后线上表数据完整

- [√] 3.8 TTS 集成与语音文件生成
  - 验证: 文案可生成音频并可下载

### 4. 前端功能

- [√] 4.1 登录与权限态展示（管理员/普通）
  - 验证: 角色区分与入口可见性正确

- [√] 4.2 任务看板与分工协作界面
  - 验证: 指派与协作流程完整

- [√] 4.3 版本配置页（版本名自动生成、模型选择、feishu 字段编辑）
  - 验证: 表单保存与加载一致

- [√] 4.4 轮播图/身份/场景/配置项/视频录入页面
  - 验证: 录入、上传、排序、启用禁用可用

- [√] 4.5 媒体规则配置页 + 压缩工具 UI
  - 验证: 可配置规则并对上传生效

- [√] 4.6 本地草稿保存/恢复 + 提交/确认/差异对比
  - 验证: 刷新后草稿仍可恢复

- [√] 4.7 操作历史与审计页面
  - 验证: 字段级与文件版本记录可追溯

### 5. 测试与交付

- [ ] 5.1 后端单元测试（diff/校验/同步）
  - 验证: `go test ./...` 通过

- [ ] 5.2 API 集成测试（核心流程）
  - 验证: 关键接口集成测试通过

- [ ] 5.3 前端关键组件测试（表单/差异对比）
  - 验证: 关键测试用例通过

- [ ] 5.4 文档与交付说明（部署/同步流程/配置）
  - 验证: 文档可按步骤完成部署

---

## 执行备注

> 执行过程中的重要记录

| 任务 | 状态 | 备注 |
|------|------|------|
